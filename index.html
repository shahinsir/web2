<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>শিক্ষা পোর্টাল | Admin Only Upload</title>
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <style>
        * { font-family: 'Hind Siliguri', sans-serif; }
        body { padding-top: 70px; background: #f8f9fa; }
        .navbar { background: linear-gradient(135deg, #1a237e 0%, #311b92 100%); }
        .hero-section { background: linear-gradient(135deg, #311b92 0%, #4527a0 100%); color: white; padding: 100px 0; }
        .material-card { transition: transform 0.3s; border: none; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .material-card:hover { transform: translateY(-5px); }
        .admin-section { display: none; background: #fff3cd; border-left: 5px solid #ffc107; }
        .mobile-warning { display: none; }
        
        .offcanvas { background: linear-gradient(135deg, #1a237e 0%, #311b92 100%); color: white; }
        .offcanvas .nav-link { color: rgba(255,255,255,0.9) !important; }
        .offcanvas .nav-link:hover { color: white !important; background: rgba(255,255,255,0.1); }
        .delete-btn { position: absolute; top: 10px; right: 10px; z-index: 10; }
        .file-preview { max-width: 100%; height: auto; border-radius: 5px; margin: 10px 0; }
        .video-preview { width: 100%; height: 200px; border-radius: 5px; margin: 10px 0; }
        
        /* Progress Bar */
        .progress { height: 10px; }
        .progress-bar { transition: width 0.3s ease; }
        
        /* File Card */
        .file-card { position: relative; }
        .file-badge { position: absolute; top: 10px; left: 10px; z-index: 5; }
        
        @media (max-width: 768px) {
            .mobile-warning { display: block; }
            body { font-size: 14px; }
            .container { padding: 0 15px; }
        }
    </style>
</head>
<body>
    <!-- Offcanvas Sidebar Menu -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">
                <i class="fas fa-graduation-cap"></i> শিক্ষা পোর্টাল
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="#home">
                        <i class="fas fa-home"></i> হোম
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#materials">
                        <i class="fas fa-book"></i> শিক্ষা উপকরণ
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#about">
                        <i class="fas fa-info-circle"></i> সম্পর্কে
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#help">
                        <i class="fas fa-question-circle"></i> সাহায্য
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#feedback">
                        <i class="fas fa-comment-dots"></i> মতামত
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showAdminLogin()">
                        <i class="fas fa-user-shield"></i> অ্যাডমিন লগিন
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <button class="btn btn-outline-light me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu">
                <i class="fas fa-bars"></i>
            </button>
            
            <a class="navbar-brand" href="#">
                <i class="fas fa-graduation-cap"></i> শিক্ষা পোর্টাল
            </a>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="#home">হোম</a></li>
                    <li class="nav-item"><a class="nav-link" href="#materials">উপকরণ</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showAdminLogin()">অ্যাডমিন</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="container text-center">
            <h1 class="display-5 fw-bold">ডিজিটাল শিক্ষা পোর্টাল</h1>
            <p class="lead">ক্লাস ৬-১০ এর সকল শিক্ষা উপকরণ এক জায়গায়</p>
            <p><strong>বাংলা, ইংরেজি, গণিত, বিজ্ঞান, ICT, কৃষি শিক্ষা</strong></p>
            <div id="stats" class="mt-4">
                <span class="badge bg-light text-dark me-2" id="totalFiles">লোড হচ্ছে...</span>
                <span class="badge bg-light text-dark" id="totalDownloads">লোড হচ্ছে...</span>
            </div>
        </div>
    </section>

    <!-- Admin Login -->
    <div id="adminLogin" class="container mt-4" style="display: none;">
        <div class="card shadow">
            <div class="card-header bg-warning">
                <h5 class="mb-0"><i class="fas fa-lock"></i> অ্যাডমিন এক্সেস</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label>পাসওয়ার্ড দিন:</label>
                    <input type="password" id="adminPass" class="form-control" placeholder="শুধু অ্যাডমিনের জন্য">
                </div>
                <button class="btn btn-danger w-100" onclick="loginAdmin()">
                    <i class="fas fa-sign-in-alt"></i> লগিন করুন
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="container mt-4 admin-section" style="display: none;">
        <div class="card shadow">
            <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-user-shield"></i> অ্যাডমিন প্যানেল</h5>
                <button class="btn btn-sm btn-light" onclick="logoutAdmin()">
                    <i class="fas fa-sign-out-alt"></i> লগআউট
                </button>
            </div>
            <div class="card-body">
                <h6>নতুন ফাইল যোগ করুন:</h6>
                <div class="row g-3">
                    <div class="col-md-3">
                        <select class="form-select" id="fileClass">
                            <option value="6">ষষ্ঠ শ্রেণি</option>
                            <option value="7">সপ্তম শ্রেণি</option>
                            <option value="8">অষ্টম শ্রেণি</option>
                            <option value="9">নবম শ্রেণি</option>
                            <option value="10">দশম শ্রেণি</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="fileSubject">
                            <option value="bangla">বাংলা</option>
                            <option value="english">ইংরেজি</option>
                            <option value="math">গণিত</option>
                            <option value="science">বিজ্ঞান</option>
                            <option value="ict">ICT</option>
                            <option value="agriculture">কৃষি শিক্ষা</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="fileType">
                            <option value="pdf">PDF</option>
                            <option value="video">ভিডিও</option>
                            <option value="image">ছবি</option>
                            <option value="doc">ডকুমেন্ট</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <input type="text" class="form-control" id="fileName" placeholder="ফাইলের নাম">
                    </div>
                    <div class="col-md-8">
                        <input type="url" class="form-control" id="fileLink" 
                               placeholder="Google Drive/YouTube লিংক (ঐচ্ছিক)">
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-primary w-100" onclick="addExternalLink()">
                            <i class="fas fa-link"></i> লিংক যোগ
                        </button>
                    </div>
                </div>
                
                <!-- Direct File Upload -->
                <div class="mt-4">
                    <h6><i class="fas fa-cloud-upload-alt"></i> সরাসরি ফাইল আপলোড:</h6>
                    <div class="border rounded p-3 text-center mb-3 upload-area" 
                         onclick="document.getElementById('directUpload').click()">
                        <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                        <p class="mb-0">ফাইল নির্বাচন করুন</p>
                        <small class="text-muted">ছবি (PNG, JPG) - 5MB | PDF - 10MB | ভিডিও - 50MB</small>
                    </div>
                    <input type="file" id="directUpload" style="display: none;" 
                           accept="image/*,video/*,.pdf,.doc,.docx" 
                           onchange="handleDirectUpload(this)">
                    <div id="uploadPreview" class="mt-2"></div>
                </div>
                
                <!-- Test Connection Buttons -->
                <div class="mt-4 p-3 border rounded bg-light">
                    <h6><i class="fas fa-vial"></i> টেস্ট কানেকশন:</h6>
                    <div class="d-flex gap-2">
                        <button class="btn btn-sm btn-info" onclick="testDatabaseConnection()">
                            <i class="fas fa-database"></i> ডাটাবেস টেস্ট
                        </button>
                        <button class="btn btn-sm btn-warning" onclick="testStorageUpload()">
                            <i class="fas fa-hdd"></i> স্টোরেজ টেস্ট
                        </button>
                        <button class="btn btn-sm btn-secondary" onclick="refreshAll()">
                            <i class="fas fa-sync-alt"></i> সব রিফ্রেশ
                        </button>
                    </div>
                </div>
                
                <!-- File Management -->
                <div class="mt-4">
                    <h6><i class="fas fa-list"></i> বিদ্যমান ফাইল ম্যানেজ করুন:</h6>
                    <div class="table-responsive">
                        <table class="table table-sm table-hover">
                            <thead>
                                <tr>
                                    <th>নাম</th>
                                    <th>ক্লাস</th>
                                    <th>বিষয়</th>
                                    <th>ধরন</th>
                                    <th>সাইজ</th>
                                    <th>কার্যক্রম</th>
                                </tr>
                            </thead>
                            <tbody id="fileManagementTable">
                                <tr>
                                    <td colspan="6" class="text-center">লোড হচ্ছে...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Materials Display -->
    <section id="materials" class="container mt-5">
        <h3 class="mb-4"><i class="fas fa-book-open"></i> শিক্ষা উপকরণ</h3>
        
        <!-- Filters -->
        <div class="row mb-4">
            <div class="col-md-3 mb-2">
                <select class="form-select" onchange="filterMaterials()" id="filterClass">
                    <option value="all">সকল ক্লাস</option>
                    <option value="6">ষষ্ঠ শ্রেণি</option>
                    <option value="7">সপ্তম শ্রেণি</option>
                    <option value="8">অষ্টম শ্রেণি</option>
                    <option value="9">নবম শ্রেণি</option>
                    <option value="10">দশম শ্রেণি</option>
                </select>
            </div>
            <div class="col-md-3 mb-2">
                <select class="form-select" onchange="filterMaterials()" id="filterSubject">
                    <option value="all">সকল বিষয়</option>
                    <option value="bangla">বাংলা</option>
                    <option value="english">ইংরেজি</option>
                    <option value="math">গণিত</option>
                    <option value="science">বিজ্ঞান</option>
                    <option value="ict">ICT</option>
                    <option value="agriculture">কৃষি শিক্ষা</option>
                </select>
            </div>
            <div class="col-md-3 mb-2">
                <select class="form-select" onchange="filterMaterials()" id="filterType">
                    <option value="all">সব ধরন</option>
                    <option value="pdf">PDF</option>
                    <option value="video">ভিডিও</option>
                    <option value="image">ছবি</option>
                    <option value="doc">ডকুমেন্ট</option>
                </select>
            </div>
            <div class="col-md-3 mb-2">
                <button class="btn btn-outline-primary w-100" onclick="loadMaterials()">
                    <i class="fas fa-sync"></i> রিফ্রেশ
                </button>
            </div>
        </div>
        
        <!-- Materials Grid -->
        <div class="row" id="materialsGrid">
            <div class="col-12 text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">ফাইলগুলো লোড হচ্ছে...</p>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="container mt-5">
        <div class="card shadow">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-info-circle"></i> সম্পর্কে</h5>
            </div>
            <div class="card-body">
                <p>শিক্ষা পোর্টাল একটি অনলাইন প্ল্যাটফর্ম যেখানে ক্লাস ৬-১০ এর সকল শিক্ষা উপকরণ ডিজিটাল ফরম্যাটে উপলব্ধ। আমাদের লক্ষ্য শিক্ষার্থীদের জন্য সহজে ও দ্রুত শিক্ষা উপকরণ পৌঁছে দেওয়া।</p>
                <p>এই প্ল্যাটফর্মে শুধু অ্যাডমিন ফাইল আপলোড করতে পারে এবং শিক্ষার্থীরা শুধু পড়তে ও ডাউনলোড করতে পারে।</p>
                <p class="mt-3">
                    <strong>সাপোর্টেড ফাইল:</strong><br>
                    • ছবি (JPG, PNG) - 5MB পর্যন্ত<br>
                    • PDF - 10MB পর্যন্ত<br>
                    • ভিডিও লিংক (YouTube, Vimeo)<br>
                    • Google Drive লিংক
                </p>
            </div>
        </div>
    </section>

    <!-- Help Section -->
    <section id="help" class="container mt-5">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-question-circle"></i> সাহায্য</h5>
            </div>
            <div class="card-body">
                <h6>সাধারণ প্রশ্ন:</h6>
                <div class="accordion" id="helpAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#help1">
                                কিভাবে ফাইল খুঁজে পাবো?
                            </button>
                        </h2>
                        <div id="help1" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                ফিল্টার ব্যবহার করে ক্লাস, বিষয় ও ফাইলের ধরন অনুযায়ী খুঁজে পাবেন।
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help2">
                                কিভাবে ফাইল ডাউনলোড করবো?
                            </button>
                        </h2>
                        <div id="help2" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                ফাইলে ক্লিক করলে তা ওপেন হবে, সেখান থেকে ডাউনলোড করতে পারবেন। ছবি/PDF গুলো সরাসরি ডাউনলোড করা যাবে।
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Feedback Section -->
    <section id="feedback" class="container mt-5 mb-5">
        <div class="card shadow">
            <div class="card-header bg-warning">
                <h5 class="mb-0"><i class="fas fa-comment-dots"></i> মতামত</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label">আপনার মতামত:</label>
                    <textarea class="form-control" id="feedbackText" rows="3" placeholder="আপনার মূল্যবান মতামত দিন..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="submitFeedback()">
                    <i class="fas fa-paper-plane"></i> পাঠান
                </button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container text-center">
            <p>শিক্ষা পোর্টাল | ক্লাস ৬-১০ | শুধু পড়ার উপকরণ</p>
            <p class="small">সব ফাইল শুধু অ্যাডমিন দ্বারা যোগ করা হয়</p>
            <p class="small mb-0">
                <span id="totalFilesFooter">ফাইল: লোড হচ্ছে...</span> | 
                <span id="totalDownloadsFooter">ডাউনলোড: লোড হচ্ছে...</span>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Custom JS Files -->
    <script src="supabase-config.js"></script>
    <script src="script.js"></script>
    
    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(() => console.log('Service Worker Registered'))
                .catch(err => console.log('Service Worker Error:', err));
        }
    </script>
</body>
</html>